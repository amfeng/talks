<!DOCTYPE html>

<!--
  Google HTML5 slide template

  Authors: Luke Mahé (code)
           Marcin Wichary (code and design)
           
           Dominic Mazzoni (browser compatibility)
           Charles Chen (ChromeVox support)

  URL: http://code.google.com/p/html5slides/
-->

<html>
  <head>
    <title>H@B Ruby on Rails Workshop 11/29/11 - Amber Feng and Jon Ko</title>
    <meta charset='utf-8'>
    <script src='http://html5slides.googlecode.com/svn/trunk/slides.js'></script>
  </head>
  
  <style>
  </style>

  <body style='display: none'>

    <section class='slides layout-regular'>
        
      <article>
        <h1>
          H@B Ruby on Rails Workshop
        </h1>
        <p>
          Amber Feng and Jon Ko
          <br>
          November 29, 2011
        </p>
      </article>
      
      <article>
        <h3>
          Introduction
        </h3>
        <ul>
          <li>
            Amber Feng
              <ul>
                <li>4th year EECS major</li>
                <li>Lots of web dev, startups, hacks, etc</li>
                <li><a href="http://www.amberfeng.com">http://www.amberfeng.com</a></li>
              </ul>
          </li>
          <li>
            Jon Ko
            <ul>
              <li>4th year EECS major</li>
              <li>...</li>
            </ul>
          </li>
          <li>
            <a href="http://www.webdesigndecal.com">Web Design Decal</a>
          </li>
          <li>
            <a href="http://hkn.eecs.berkeley.edu">HKN Website</a> 
          </li>
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Ruby on Rails? 
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h2>
          Demo App - Facebook
        </h2>
      </article>

       <article>
        <h2>
          Rails Internals
        </h2>
      </article>

      <article>
        <h3>
          method_missing
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Asset Pipeline
        </h3>
        <ul>
          <li>
            Concatenating, compressing, minifying assets (<code>js</code>, <code>css</code>)
              <ul>
                <li>By default, concatenate all files into one master file for each type</li>
                <li>
                  Specify which compressor to use
                  <pre>config.assets.css_compressor = :yui</pre>
                  <pre>config.assets.js_compressor = :closure</pre>
                  Note: The respective <code>yui-compressor</code> and <code>closure-compiler</code> gems need to be installed
                </li>
              </ul>
          </li>
        </ul>
      </article>

      <article>
        <h3>Asset Pipeline (cont'd)</h3>
        <ul>
          <li>
            Using Sass, Haml, CoffeeScript, etc.
            <pre>
$blue: #3bbfce
$margin: 16px

.content-navigation
  color: darken($blue, 9%)
  div
    padding: $margin / 2</pre>

          </li>
          <li>Static files go in <code>public/</code> (as always), files to be pre-processed go in <code>app/assets/</code>
          <li>When files are requested, ex. <code>app.js.coffee</code>, processed by the appropriate gem first (<code>coffee-script</code>), then sent to the browser as <code>js</code> file
        </ul>
      </article>

      <article>
        <h3>Asset Pipeline: Fingerprinting</h3>
        <ul>
          <li>
            The old way: (timestamped)
            <pre>/stylesheets/global.css?1309495796</pre> 
          </li>
          <li>
            The new way:  (MD5 hash of file contents)
            <pre>/stylesheets/global-908e25f4bf641868d8683022a5b62f54.css</pre>
            <ul>
              <li>Allow maximum caching</li>
              <li>Better for multi-server environments where timestamps are not guaranteed to be the same</li>
            </ul>
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Middleware/Rack
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Rails Stack Flow
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <!-- Insert other magic-like Rails things, snippets of Rails source code? -->

      <article>
        <h2>
          Best Practices
        </h2>
      </article>

      <article>
        <h3>
          Partials
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          ActiveRecord
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Routes
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <!-- Insert other Best Practices slides? -->

      <article>
        <h2>
          Performance
        </h2>
      </article>

      <article>
        <h3>Find your Bottlenecks</h3>
      </article>

      <article>
        <h3>Caching</h3>
        Temporary storage of generated HTML pages to avoid requests from having to go through the (slower) Rails stack.
        <ul>
          <li>First:
            Enable caching
            <pre>config.action_controller.perform_caching = true</pre>
            (Disabled by default for <code>development</code> and <code>test</code> environments)
          </li>
          <li>
            Next: 
            What level of caching to use?
            <ul>
              <li>Page Caching</li>
              <li>Action Caching</li>
              <li>Fragment Caching</li>
            </ul>
          </li>
        </ul>
      </article>

      <article>
        <h3>Caching: Page Caching</h3>
        Allows page to be served by the webserver instead of going through the Rails stack.
        <ul>
          <li>Faster, but for "static" pages only, not for dynamic/authenticated content</li>
          <li>GET parameters ignored, won't work for pagination ex. <code>users.html?page=1</code> vs <code>users.html?page=2</code></li>
        </ul>
        <pre>
class UsersController < ActionController
  caches_page :index
 
  def index
    @users = User.all
  end
end
</pre>
      </article>

      <article>
        <h3>Caching: Action Caching</h3>
        Request goes through the Rails stack first (ex. so filters can run), then cached copy is served.
        <ul>
          <li>Pass in a block via <code>if</code> or <code>unless</code> to specify when the action should be cached</li>
          <li>Use <code>:layout => false</code> to cache without the layout (which typically contains logged in user information, etc</li>
        </ul>
        <pre>
class UsersController < ActionController
  before_filter :logged_in
  caches_action :index
 
  def index
    @users = User.all
  end
end
</pre>
      </article>

      <article>
        <h3>Caching: Fragment Caching</h3>
        Fine-grained control over caching specific parts of a page.
        <ul>
          <li>Pass in a block via <code>if</code> or <code>unless</code> to specify when the action should be cached</li>
          <li>Use <code>:layout => false</code> to cache without the layout (which typically contains logged in user information, etc</li>
        </ul>
<pre>
<%= @current_user.name if @current_user %>

<% cache 'fragment-name' %>
  <% for i in @items %>
    <%= i.name %>
  <% end %>
<% end %>
</pre>
      </article>

      <article>
        <h3>Caching: Page Expirations</h3>
        <ul>
          <li>The simple/tedious way:
<pre>
expire_[page|action] :action => :index
</pre>
<pre>
expire_fragment 'fragment-name'
</pre>
          </li>
          <li>
            Sweepers
            <pre>
class UserSweeper < ActionController::Caching::Sweeper
  observe User 

  def after_create(user)
    expire_page :controller => :users, :action => :index
  end
end
</pre>
          </li>
        </ul>
      </article>

      <article>
        <h3>Rails Performance Tips</h3>
        <ul>
          <li>
            Eagerly load associations
            <pre>
              // Do this
            </pre>  
          </li>
          <li>
            Include as much asynchrony as possible (<code>DelayedJob</code>/<code>BackgroundJob</code>)
          </li>
          <li>
            Template inlining
          </li>
          <li>
            SQL Caching
              <ul>
                <li>Rails does this already, within actions</li>
              </ul>
          </li>
        </ul>
      </article>

      <article>
        <h3>Other (general) perforamnce Tips</h3>
        <ul>
          <li>Minify <code>js</code> and <code>css</code></li>
          <li>Sprites</li>
        </ul>
      </article>

      <article>
        <h2>
          Security
        </h2>
      </article>

      <article>
        <q>Whitelist, don't blacklist.</q>
      </article>

      <article>
        <h3>Session Hijacking</h3>
      </article>

      <article>
        <h3>Cross-site Request Forgery (CSRF)</h3>
      </article>

      <article>
        <h3>Cross-site Scripting (XSS)</h3>
      </article>

      <article>
        <h3>SQL Injection</h3>
      </article>

      <article>
        <h3>Password Hashing/Salting</h3>
      </article>

      <article>
        <h2>
          Practical Things
        </h2>
      </article>

      <article>
        <h3>
          Rails Must-Haves
        </h3>
        <ul>
          <li>Authentication (<code>restful_authentication</code>, <code>authlogic</code>)</li>
          <li>Emailing (<code>ActionMailer</code>)</li>
          <li>File uploads (<code>paperclip</code>, <code>attachment_fu</code>)</li>
          <li>Exception Notification (<code>exception_notification</code>, Hoptoad)</li>
          <!--<li>What_column</li>-->
        </ul>
      </article>

      <article>
        <h3>
          Deploying
        </h3>
        <ul>
          <li>
            Heroku
          </li>
          <li>
            Capistrano
          </li>  
        </ul>
      </article>

      <article>
        <h3>
          Gems
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Writing your own Gems/plugins 
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          RVM
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Testing and RSpec
        </h3>
        <ul>
          <li>
            (fill in)
          </li>
        </ul>
      </article>

      <!--
      <article>
        <h3>
          Slide with an image
        </h3>
        <p>
          <img style='height: 500px' src='images/example-graph.png'>
        </p>
        <div class='source'>
          Source: Sergey Brin
        </div>
      </article>

      <article>
        <h3>
          Slide with an image (centered)
        </h3>
        <p>
          <img class='centered' style='height: 500px' src='images/example-graph.png'>
        </p>
        <div class='source'>
          Source: Larry Page
        </div>
      </article>

      <article class='fill'>
        <h3>
          Image filling the slide (with optional header)
        </h3>
        <p>
          <img src='images/example-cat.jpg'>
        </p>
        <div class='source white'>
          Source: Eric Schmidt
        </div>
      </article>

      <article>
        <h3>
          This slide has some code
        </h3>
        <section>
        <pre>
          // Code 
          1 < 4
        </pre>
        </section>
      </article>
      
      <article class='smaller'>
        <h3>
          This slide has some code (small font)
        </h3>
        <section>
        <pre>
          // Code
        </pre>
        </section>
      </article>
      
      <article>
        <q>
          The best way to predict the future is to invent it.
        </q>
        <div class='author'>
          Alan Kay
        </div>
      </article>
      
      <article class='smaller'>
        <q>
          A distributed system is one in which the failure of a computer 
          you didn’t even know existed can render your own computer unusable.
        </q>
        <div class='author'>
          Leslie Lamport
        </div>
      </article>
      
      <article class='nobackground'>
        <h3>
          A slide with an embed + title
        </h3>
        
        <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
      </article>

      <article class='nobackground'>
        <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
      </article>

      <article class='fill'>
        <h3>
          Full-slide embed with (optional) slide title on top
        </h3>
        <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
      </article>
      
      <article>
        <h3>
          Thank you!
        </h3>
        
        <ul>
          <li>
            <a href='http://www.google.com'>google.com</a>
        </ul>
      </article>
    -->
    </section>
  </body>
</html>

